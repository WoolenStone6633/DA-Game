<!DOCTYPE html>
<html>
    <head>
        <title>Solitaire</title>
        <style type="text/css">
        #game_board {position:absolute; left:11%;  width:75%;}
        #board {position:relative; width:100%; z-index:-2}
        #redo {position: absolute; opacity:0.9; left:1%; top:0%; width:11.4%; z-index:-1}
        #heart_back {position:absolute; opacity:0.7; left:56%; top:0%; width:10%; z-index:-1}
        #diamond_back {position:absolute; opacity:0.7; left:67%; top:0%; width:10%; z-index:-1}
        #club_back {position:absolute; opacity:0.7; left:78%; top:0%; width:10%; z-index:-1}
        #spade_back {position:absolute; opacity:0.7; left:89%; top:0%; width:10%; z-index:-1}
        #stack {position:absolute; left:1.5%; top:0%; width:100%}
        #column0 {position:absolute; left:3%; top:25%; width:100%}
        #column1 {position:absolute; left:17%; top:25%; width:100%; height: 100%}
        #column2 {position:absolute; left:31%; top:25%; width:100%; height: 100%}
        #column3 {position:absolute; left:45%; top:25%; width:100%; height: 100%}
        #column4 {position:absolute; left:59%; top:25%; width:100%; height: 100%}
        #column5 {position:absolute; left:73%; top:25%; width:100%; height: 100%}
        #column6 {position:absolute; left:87%; top:25%; width:100%; height: 100%}
        .card {position:absolute; width:10.4%; z-index:0}
        </style>


        <script> //Class to define a playing card and it's properties
            class Cards {
                value;
                suit;
                flipFlag;

                constructor(value, suit){
                    this.value = value;
                    this.suit = suit;
                    this.flipFlag = false;
                }
                get value() {
                    return this.value;
                }
                get suit() {
                    return this.suit;
                }
                get id() {
                   return  this.value + "_of_" + this.suit;
                }
                get link() {
                    if(this.flipFlag){
                        return "Playing Cards/Back.png";
                    }
                    return "Playing Cards/" + this.value + "_of_" + this.getSuit(this.suit) + ".png";
                }
                getSuit(suit) {
                    if (suit == 0) {
                        return "hearts";
                    } else if (suit == 1) {
                        return "diamonds";
                    } else if (suit == 2) {
                        return "clubs";
                    } else if (suit == 3) {
                        return "spades";
                    }
                }
                flip(){
                    this.flipFlag = !this.flipFlag;
                }
            }
            var column0 = [];
            var column1 = [];
            var column2 = [];
            var column3 = [];
            var column4 = [];
            var column5 = [];
            var column6 = [];
            var heartStack = [];
            var diamondStack = [];
            var clubStack = [];
            var spadeStack = [];
            var resetStack = [];
            var discardStack = [];
            
            function moveCard(moveFrom, moveTo){
                moveFrom.push(moveTo.pop());
                return;
            }
        </script>

        <script> //For setting up the board. Placing cards, randomizing their order, etc.
            function setGame() {
                let initialStack = []
                for (let suit = 0; suit < 4; suit++) {
                    for (let value = 1; value <= 13; value++) {
                        let card = new Cards(value, suit);
                        initialStack.push(card);
                    }
                }
                //Randomizes the order of the cards
                randomizer(initialStack);

                //Places the cards on the board in their correct initial spot
                let temp = 0;
                for (let i = (initialStack.length -1); i >= 0; i--) {
                    if (i >= 28) {
                        initialStack[i].flip();
                        placeCard(initialStack[i], "stack");
                    } else if (i == 27) {
                        placeCard(initialStack[i], "column0");
                    } else if (i >= 25) {
                        if(i != 25){
                            initialStack[i].flip();
                        }
                        addToColumn(initialStack[i], "column1");
                    } else if (i >= 22) {
                        if(i != 22){
                            initialStack[i].flip();
                        }
                        addToColumn(initialStack[i], "column2");
                    } else if (i >= 18) {
                        if(i != 18){
                            initialStack[i].flip();
                        }
                        addToColumn(initialStack[i], "column3");
                    } else if (i >= 13) {
                        if(i != 13){
                            initialStack[i].flip();
                        }
                        addToColumn(initialStack[i], "column4");
                    } else if (i >= 7) {
                        if(i != 7){
                            initialStack[i].flip();
                        }
                        addToColumn(initialStack[i], "column5");
                    } else if (i >= 0) {
                        if(i != 0){
                            initialStack[i].flip();
                        }
                        addToColumn(initialStack[i], "column6");
                    }
                }
            }
        </script>

        <script>
            function placeCard(card, location){
                let domCard = document.createElement("div");
                domCard.id = card.id;
                domCard.classList.add("card");
                document.getElementById(location).append(domCard);

                let img = document.createElement("img");
                img.src = card.link;
                img.style.width = "100%";
                document.getElementById(card.id).appendChild(img);
            }
        </script>

        <script> //Places a card in the column. Places it in the correct position away from the other card under it
            function addToColumn(card, location) {
                let shift = 3.3;
                if (document.getElementById(location).childNodes.length == 0){
                    placeCard(card, location);
                } else {
                    placeCard(card, location);
                    shiftDown(card.id, (Math.ceil(parseInt(window.getComputedStyle(document.getElementById(location).childNodes[document.getElementById(location).childNodes.length - 2])["top"])/parseInt(window.getComputedStyle(document.getElementById("board"))["height"]) * 10000) + shift * 100) / 100);
                }
            }
        </script>

        <script> //For moving a card down a specific amount
            function shiftDown(item, amount) {
                document.getElementById(item).style.top = (Math.ceil(parseInt(window.getComputedStyle(document.getElementById(item))["top"])/parseInt(window.getComputedStyle(document.getElementById("board"))["height"]) * 100) + amount) + "%";
            }
        </script>

        <script> //Script for randomizing the order of any array
            function randomizer(array){
                for (let i = 0; i < array.length; i++) {
                    let temp = Math.floor(Math.random() * (array.length));
                    [array[temp], array[i]] = [array[i], array[temp]];
                }
            }
         </script>
    </head>
    <body onload="setGame()">
        <div id="game_board">
            <div id="board">
                <img src="Board assets/Felt_table.jpg" alt="felt table" width="100%">
            </div>
            <div id="redo">
                <img src="Board assets/Screenshot 2023-09-25 192652.png" alt="felt table" width="100%">
            </div>
            <div id="club_back">
                <img src="Board assets/Club_Back.png" width="100%">
            </div>
            <div id="spade_back">
                <img src="Board assets/Spade_Back.png" width="100%">
            </div>
            <div id="heart_back">
                <img src="Board assets/Heart_Back.png" width="100%">
            </div>
            <div id="diamond_back">
                <img src="Board assets/Diamond_Back.png" width="100%">
            </div>
            <div id="stack"></div>
            <div id="column0"></div>
            <div id="column1"></div>
            <div id="column2"></div>
            <div id="column3"></div>
            <div id="column4"></div>
            <div id="column5"></div>
            <div id="column6"></div>
        </div>
    </body>
</html>
